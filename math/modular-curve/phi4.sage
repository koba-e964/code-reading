# From https://math.mit.edu/~drew/modpolys/jfiles/phi_j_4.txt
phi4 = {
    (0,0): 280949374722195372109640625000000000000,
    (1,0): -364936327796757658404375000000000000,
    (1,1): -94266583063223403127324218750000,
    (2,0): 158010236947953767724187500000000,
    (2,1): 188656639464998455284287109375,
    (2,2): 26402314839969410496000000,
    (3,0): -22805180351548032195000000000,
    (3,1): 12519806366846423598750000,
    (3,2): -914362550706103200000,
    (3,3): 2729942049541120,
    (4,0): 24125474716854750000,
    (4,1): 1194227244109980000,
    (4,2): 1425220456750080,
    (4,3): 80967606480,
    (4,4): 7440,
    (5,0): -8507430000,
    (5,1): 561444609,
    (5,2): -2533680,
    (5,3): 2976,
    (5,4): -1,
    (6,0): 1,
}
K.<q> = Frac(QQ[['q']])
j1 = j_invariant_qexp(prec = 12)
j2 = j1(-q)
total = 0
for d1, d2 in phi4:
    coef = phi4[(d1, d2)]
    total += j1^d1 * j2^d2 * coef
    if d1 != d2:
        total += j1^d2 * j2^d1 * coef
print(f"Phi_4(j(q), j(-q)) = {total}")
